{"componentChunkName":"component---src-templates-blog-post-js","path":"/rotate-actor-around-player-with-rotation/","result":{"data":{"site":{"siteMetadata":{"title":"Unreal C++"}},"markdownRemark":{"id":"8deecd51-92a4-5638-9dde-e61219492206","excerpt":"Github Link: https://github.com/Harrison1/unrealcpp/tree/master/RotateActorAroundWithRotation For this tutorial we are using the standard first person Câ€¦","html":"<p><strong>Github Link: <a href=\"https://github.com/Harrison1/unrealcpp/tree/master/RotateActorAroundWithRotation\">https://github.com/Harrison1/unrealcpp/tree/master/RotateActorAroundWithRotation</a></strong></p>\n<p><em>For this tutorial we are using the standard first person C++ template with starter content. If you don't know how to add a new actor class to your project, please visit the <a href=\"/add-actor-class\">Add C++ Actor Class</a> post.</em></p>\n<p>In this tutorial we will be rotating an actor around a set point in the game world with it always facing the origin. Start by creating a new <code>C++</code> actor class and call it <strong>RotateActorAroundWithRotation</strong>. In the header file we'll create two <code>float</code> variables and two <code>FVector</code> variables and make them <code>EditAnywhere</code> so we can edit them later on inside the editor. Below is the final header file code.</p>\n<h3>RotateActorAroundWithRotation.cpp</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">once</span></span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"CoreMinimal.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"GameFramework/Actor.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"RotateActorAroundWithRotation.generated.h\"</span></span>\n\n<span class=\"token function\">UCLASS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">UNREALCPP_API</span> ARotateActorAroundWithRotation <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> AActor\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">GENERATED_BODY</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\t\n\t<span class=\"token comment\">// Sets default values for this actor's properties</span>\n\t<span class=\"token function\">ARotateActorAroundWithRotation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">protected</span><span class=\"token operator\">:</span>\n\t<span class=\"token comment\">// Called when the game starts or when spawned</span>\n\t<span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">BeginPlay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">override</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\t\n\t<span class=\"token comment\">// Called every frame</span>\n\t<span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Tick</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> DeltaTime<span class=\"token punctuation\">)</span> <span class=\"token keyword\">override</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">// declare our float variables</span>\n\t<span class=\"token function\">UPROPERTY</span><span class=\"token punctuation\">(</span>EditAnywhere<span class=\"token punctuation\">,</span> Category <span class=\"token operator\">=</span> Movement<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">float</span> AngleAxis<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token function\">UPROPERTY</span><span class=\"token punctuation\">(</span>EditAnywhere<span class=\"token punctuation\">,</span> Category <span class=\"token operator\">=</span> Movement<span class=\"token punctuation\">)</span>\n\tFVector Dimensions<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token function\">UPROPERTY</span><span class=\"token punctuation\">(</span>EditAnywhere<span class=\"token punctuation\">,</span> Category <span class=\"token operator\">=</span> Movement<span class=\"token punctuation\">)</span>\n\tFVector AxisVector<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token function\">UPROPERTY</span><span class=\"token punctuation\">(</span>EditAnywhere<span class=\"token punctuation\">,</span> Category <span class=\"token operator\">=</span> Movement<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">float</span> Multiplier<span class=\"token punctuation\">;</span>\n\t\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>In the <code>.cpp</code> let's start by setting some default values for our actor. I took some time playing around with the variables so I think my default should suffice to get us going, but feel free to change them to whatever you want.</p>\n<h4>default values</h4>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// Sets default values</span>\n<span class=\"token class-name\">ARotateActorAroundWithRotation</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">ARotateActorAroundWithRotation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n \t<span class=\"token comment\">// Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.</span>\n\tPrimaryActorTick<span class=\"token punctuation\">.</span>bCanEverTick <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n\tDimensions <span class=\"token operator\">=</span> <span class=\"token function\">FVector</span> <span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tAxisVector <span class=\"token operator\">=</span> <span class=\"token function\">FVector</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tMultiplier <span class=\"token operator\">=</span> <span class=\"token number\">50.f</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>All of our logic is going to go in the <code>Tick</code> function. Every frame we want to set our fixed location by setting our <code>NewLocation</code> to a fixed <code>FVector</code> variable. In your game you might want to connect the <code>NewLocation</code> to another actor or at least make it <code>EditAnywhere</code> in the editor, but for this tutorial let's just set it and move on. Alternatively, you can set <code>NewLocation</code> to the player location so the actor always rotates around the player.</p>\n<p>Next, we want to add to our <code>AngleAxis</code> variable which will indicate the degree around the point the actor should move to. We add <code>DeltaTime</code> multiplied by our <code>Multiplier</code> for smooth movement. If <code>AngleAxis</code> is greater than or equal to 360 we re-set the <code>AngleAxis</code> to 0.</p>\n<p>Next, we'll set <code>RotateValue</code> by using the <code>RotateAngleAxis</code> functions from our <code>Dimensions</code> vector. This will return the amount of units needed to move the actor to its next location. Add <code>RotateValue</code>'s X, Y, and Z values to our <code>NewLocation</code> variable accordingly. Next, we'll configure our new ration by making a <code>FRotator</code> value and setting the value to <code>FRotator(0, AngleAxis, 0)</code>. Then we'll make a <code>FQuat</code> using the <code>NewRotation</code> value.</p>\n<p>Finally, set the actor's location and rotation with <code>SetActorLocationAndRotation</code> to our <code>NewLocation</code>.</p>\n<h3>Tick function</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// Called every frame</span>\n<span class=\"token keyword\">void</span> <span class=\"token class-name\">ARotateActorAroundWithRotation</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">Tick</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> DeltaTime<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token class-name\">Super</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">Tick</span><span class=\"token punctuation\">(</span>DeltaTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\tFVector NewLocation <span class=\"token operator\">=</span> <span class=\"token function\">FVector</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">// rotate around player</span>\n\t<span class=\"token comment\">// FVector NewLocation = GetWorld()->GetFirstPlayerController()->GetPawn()->GetActorLocation();</span>\n\t\n\tAngleAxis <span class=\"token operator\">+=</span> DeltaTime <span class=\"token operator\">*</span> Multiplier<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>AngleAxis <span class=\"token operator\">>=</span> <span class=\"token number\">360.0f</span><span class=\"token punctuation\">)</span> \n\t<span class=\"token punctuation\">{</span>\n\t\tAngleAxis <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tFVector RotateValue <span class=\"token operator\">=</span> Dimensions<span class=\"token punctuation\">.</span><span class=\"token function\">RotateAngleAxis</span><span class=\"token punctuation\">(</span>AngleAxis<span class=\"token punctuation\">,</span> AxisVector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\tNewLocation<span class=\"token punctuation\">.</span>X <span class=\"token operator\">+=</span> RotateValue<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">;</span>\n\tNewLocation<span class=\"token punctuation\">.</span>Y <span class=\"token operator\">+=</span> RotateValue<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">;</span>\n\tNewLocation<span class=\"token punctuation\">.</span>Z <span class=\"token operator\">+=</span> RotateValue<span class=\"token punctuation\">.</span>Z<span class=\"token punctuation\">;</span>\n\n\tFRotator NewRotation <span class=\"token operator\">=</span> <span class=\"token function\">FRotator</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> AngleAxis<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\tFQuat QuatRotation <span class=\"token operator\">=</span> <span class=\"token function\">FQuat</span><span class=\"token punctuation\">(</span>NewRotation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token function\">SetActorLocationAndRotation</span><span class=\"token punctuation\">(</span>NewLocation<span class=\"token punctuation\">,</span> QuatRotation<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ETeleportType<span class=\"token double-colon punctuation\">::</span>None<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Compile the code. Drag and drop the new actor into the game world. Add a static mesh component to the actor. Now when you push play the actor will find and circle around the given vector point and always point towards the origin. Below is the final <code>.cpp</code> file.</p>\n<h3>RotateActorAroundWithRotation.cpp</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"RotateActorAroundWithRotation.h\"</span></span>\n\n\n<span class=\"token comment\">// Sets default values</span>\n<span class=\"token class-name\">ARotateActorAroundWithRotation</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">ARotateActorAroundWithRotation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n \t<span class=\"token comment\">// Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.</span>\n\tPrimaryActorTick<span class=\"token punctuation\">.</span>bCanEverTick <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n\tDimensions <span class=\"token operator\">=</span> <span class=\"token function\">FVector</span> <span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tAxisVector <span class=\"token operator\">=</span> <span class=\"token function\">FVector</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tMultiplier <span class=\"token operator\">=</span> <span class=\"token number\">50.f</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Called when the game starts or when spawned</span>\n<span class=\"token keyword\">void</span> <span class=\"token class-name\">ARotateActorAroundWithRotation</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">BeginPlay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token class-name\">Super</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">BeginPlay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Called every frame</span>\n<span class=\"token keyword\">void</span> <span class=\"token class-name\">ARotateActorAroundWithRotation</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">Tick</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> DeltaTime<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token class-name\">Super</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">Tick</span><span class=\"token punctuation\">(</span>DeltaTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\tFVector NewLocation <span class=\"token operator\">=</span> <span class=\"token function\">FVector</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">// rotate around player</span>\n\t<span class=\"token comment\">// FVector NewLocation = GetWorld()->GetFirstPlayerController()->GetPawn()->GetActorLocation();</span>\n\t\n\tAngleAxis <span class=\"token operator\">+=</span> DeltaTime <span class=\"token operator\">*</span> Multiplier<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>AngleAxis <span class=\"token operator\">>=</span> <span class=\"token number\">360.0f</span><span class=\"token punctuation\">)</span> \n\t<span class=\"token punctuation\">{</span>\n\t\tAngleAxis <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tFVector RotateValue <span class=\"token operator\">=</span> Dimensions<span class=\"token punctuation\">.</span><span class=\"token function\">RotateAngleAxis</span><span class=\"token punctuation\">(</span>AngleAxis<span class=\"token punctuation\">,</span> AxisVector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\tNewLocation<span class=\"token punctuation\">.</span>X <span class=\"token operator\">+=</span> RotateValue<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">;</span>\n\tNewLocation<span class=\"token punctuation\">.</span>Y <span class=\"token operator\">+=</span> RotateValue<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">;</span>\n\tNewLocation<span class=\"token punctuation\">.</span>Z <span class=\"token operator\">+=</span> RotateValue<span class=\"token punctuation\">.</span>Z<span class=\"token punctuation\">;</span>\n\n\tFRotator NewRotation <span class=\"token operator\">=</span> <span class=\"token function\">FRotator</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> AngleAxis<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\tFQuat QuatRotation <span class=\"token operator\">=</span> <span class=\"token function\">FQuat</span><span class=\"token punctuation\">(</span>NewRotation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token function\">SetActorLocationAndRotation</span><span class=\"token punctuation\">(</span>NewLocation<span class=\"token punctuation\">,</span> QuatRotation<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ETeleportType<span class=\"token double-colon punctuation\">::</span>None<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"Rotate Actor Around Player With Rotation","date":"December 02, 2017","description":"Tutorial on how to rotate an actor around a point while always having the actor face the origin.","image":"https://res.cloudinary.com/dz09rnbhe/image/upload/unrealcpp/rotate-object-with-rotation_x1loge.jpg","tags":["rotation","location"],"video":"IKb7pb--U24","uev":"4.18.3"}},"previous":{"fields":{"slug":"/rotate-around-vector/"},"frontmatter":{"title":"Rotate Around Vector"}},"next":{"fields":{"slug":"/rotate-actor-around-player/"},"frontmatter":{"title":"Rotate Actor Around Player"}}},"pageContext":{"id":"8deecd51-92a4-5638-9dde-e61219492206","previousPostId":"2a40dbb9-ed82-5882-b02b-43a76ae92335","nextPostId":"329b898e-6c37-51b1-85be-587a75b52757"}},"staticQueryHashes":[],"slicesMap":{}}